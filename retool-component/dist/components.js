var Ke=Object.create;var Se=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var Qe=Object.getOwnPropertyNames;var Xe=Object.getPrototypeOf,Ze=Object.prototype.hasOwnProperty;var tn=(n,i)=>()=>(i||n((i={exports:{}}).exports,i),i.exports);var en=(n,i,l,g)=>{if(i&&typeof i=="object"||typeof i=="function")for(let p of Qe(i))!Ze.call(n,p)&&p!==l&&Se(n,p,{get:()=>i[p],enumerable:!(g=Je(i,p))||g.enumerable});return n};var nn=(n,i,l)=>(l=n!=null?Ke(Xe(n)):{},en(i||!n||!n.__esModule?Se(l,"default",{value:n,enumerable:!0}):l,n));var Fe=tn((mn,De)=>{De.exports=window.ccc_support_React});var a=nn(Fe());var{Retool:h}=window.ccc_support_RetoolCustomComponenCollections;var{Fragment:St,jsxs:d,jsx:o,default:vn}=window.ccc_support_ReactJSXRuntime;var on=n=>{if(n==null||n===""||n==="nan")return"";let i=String(n);if(/^\d{4}-\d{2}-\d{2}/.test(i)){let l=new Date(i);if(!isNaN(l.getTime()))return l.toLocaleDateString("en-GB",{day:"2-digit",month:"short"})}return i},V=(n,i)=>n?(typeof n=="string"?n:String(n)).replace(/\{(\w+)\}/g,(g,p)=>on(i[p])):"",rn=(n,i)=>{let l=typeof n=="string"?n:String(n||""),g=V(l,i),p=l.replace(/\{(\w+)\}/g,"");return g.trim()===p.trim()||g.trim()===""},Z=36e5,Wt=n=>{if(!n)return null;let l=n.split("T")[0].split("-").map(Number);if(l.length!==3||l.some(isNaN))return null;let g=new Date(l[0],l[1]-1,l[2],0,0,0,0);return isNaN(g.getTime())?null:g},sn=n=>{let i=new Date(n);return i.setHours(0,0,0,0),i},Ee=n=>n.getDay()!==0&&n.getDay()!==6,Kt=(n,i)=>{let l=new Date(n);for(l.setHours(i,0,0,0);l.getDay()===0||l.getDay()===6;)l.setDate(l.getDate()+1);return l},st=(n,i,l,g)=>{let p=new Date(n);!Ee(p)||p.getHours()>=g?p=Kt(new Date(p.getTime()+Z*12),l):p.getHours()<l&&p.setHours(l,0,0,0);let R=i,x=new Date(p);for(;R>0;){if(!Ee(x)){x=Kt(new Date(x.getTime()+Z*12),l);continue}let I=g-x.getHours(),W=Math.min(R,I);x.setTime(x.getTime()+W*Z),R-=W,R>0&&(x=Kt(new Date(x.getTime()+Z*12),l))}return x},an=(n,i)=>{let l=[],g=new Date(n);for(let p=0;p<i;p++)l.push(new Date(g)),g.setDate(g.getDate()+1);return l},ln=(n,i)=>{let l=[],g=new Date(n);for(;g.getDay()!==1;)g.setDate(g.getDate()-1);let p=new Date(n);for(p.setDate(p.getDate()+i);g<p;)l.push(new Date(g)),g.setDate(g.getDate()+7);return l},G=(n,i)=>(i.getTime()-n.getTime())/Z,dn=n=>`W/C ${n.toLocaleDateString("en-GB",{day:"2-digit",month:"short"})}`,cn=n=>{if(!n||n==="nan")return"In Progress";let i=n.toLowerCase().trim();return i==="ready"?"Ready":i==="parts not assigned"?"Parts Not Assigned":"In Progress"},un=(n,i=null)=>{let l=cn(n.part_status);if(l==="Ready")return"Ready";if(l==="Parts Not Assigned")return"Parts Not Assigned";if(i&&n.part_ready_date){let g=Wt(n.part_ready_date),p=sn(i);if(g&&p)return g.getTime()>p.getTime()?"Delayed":"On Time"}return"In Progress"},Dt=n=>n.status==="Running",Qt={Running:"#9333EA",Ready:"#22C55E","On Time":"#E5A00D",Delayed:"#EF4444","Parts Not Assigned":"#9CA3AF","In Progress":"#D1D5DB"},we={Running:"#7E22CE",Ready:"#16A34A","On Time":"#B45309",Delayed:"#DC2626","Parts Not Assigned":"#6B7280","In Progress":"#9CA3AF"},at=n=>Qt[n]||Qt["In Progress"],zt=n=>we[n]||we["In Progress"],_t=(n,i=null)=>Dt(n)?"Running":un(n,i),Xt=n=>{let l=Math.max(0,Math.min(100,typeof n=="number"?n:50));return l<=30?"#6B7280":l<=60?"#F59E0B":l<=80?"#EA580C":"#DC2626"};var m={container:{display:"flex",height:"100%",background:"#F9FAFB",overflow:"hidden",fontFamily:"'DM Sans', sans-serif",position:"relative"},sidebar:{width:320,minWidth:320,background:"#FFFFFF",borderRight:"1px solid #E5E7EB",display:"flex",flexDirection:"column"},mono:{fontFamily:"'JetBrains Mono', monospace"}},Ce=()=>d("div",{style:{position:"absolute",top:2,bottom:2,width:3,background:"#3B82F6",borderRadius:2,zIndex:30,boxShadow:"0 0 12px #3B82F6, 0 0 4px #3B82F6",pointerEvents:"none"},children:[o("div",{style:{position:"absolute",top:-4,left:-4,width:11,height:11,borderRadius:"50%",background:"#3B82F6"}}),o("div",{style:{position:"absolute",bottom:-4,left:-4,width:11,height:11,borderRadius:"50%",background:"#3B82F6"}})]}),pn=()=>d("div",{style:{padding:"10px 16px",borderTop:"1px solid #E5E7EB",background:"#F9FAFB"},children:[o("h3",{style:{...m.mono,fontSize:11,fontWeight:700,letterSpacing:"0.08em",textTransform:"uppercase",color:"#4B5563",marginBottom:6},children:"Status Key"}),o("div",{style:{display:"flex",flexWrap:"wrap",gap:"4px 0"},children:["Running","Ready","On Time","Delayed","Parts Not Assigned"].map(n=>d("div",{style:{display:"flex",alignItems:"center",gap:6,width:"50%",minWidth:0},children:[o("div",{style:{width:4,height:14,background:Qt[n],borderRadius:2,flexShrink:0}}),o("span",{style:{...m.mono,fontSize:9,color:zt(n),fontWeight:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:n.toUpperCase()})]},n))})]}),It=({label:n,icon:i,onClick:l})=>{let[g,p]=a.default.useState(!1);return d("div",{onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),onClick:l,style:{padding:"8px 14px",fontSize:13,fontWeight:500,color:"#111827",cursor:"pointer",background:g?"#F3F4F6":"transparent",display:"flex",alignItems:"center",gap:8,userSelect:"none"},children:[i&&o("span",{style:{fontSize:14,width:18,textAlign:"center",color:"#6B7280"},children:i}),n]})},gn=({menu:n,statusOptionsList:i,priorityInputValue:l,onClose:g,onModeChange:p,onPriorityInputChange:R,onConfirmPriority:x,onPickStatus:I,onEditTest:W,panelRef:U})=>{let lt=Math.min(n.x,window.innerWidth-210),K=Math.min(n.y,window.innerHeight-150);return d("div",{ref:U,onContextMenu:F=>F.preventDefault(),style:{position:"fixed",left:lt,top:K,zIndex:3e3,background:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:10,boxShadow:"0 4px 16px rgba(0,0,0,0.12), 0 1px 4px rgba(0,0,0,0.06)",minWidth:200,overflow:"hidden"},children:[o("div",{style:{padding:"10px 14px 8px",borderBottom:"1px solid #E5E7EB",background:"#F9FAFB"},children:o("div",{style:{fontSize:13,fontWeight:700,color:"#111827",lineHeight:1.3,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:180},children:n.test.name})}),n.mode==="root"&&d("div",{style:{padding:"4px 0"},children:[o(It,{label:"Change Priority",icon:"\u2B06",onClick:()=>p("priority")}),o(It,{label:"Change Status",icon:"\u25C9",onClick:()=>p("status")}),o(It,{label:"Edit Test",icon:"\u270E",onClick:W})]}),n.mode==="priority"&&d("div",{style:{padding:"10px 14px"},children:[o("div",{style:{fontSize:12,color:"#6B7280",marginBottom:8},children:"Enter priority (0\u2013100):"}),o("input",{type:"number",min:0,max:100,autoFocus:!0,value:l,onChange:F=>R(F.target.value),onKeyDown:F=>{F.key==="Enter"&&x(),F.key==="Escape"&&g()},style:{width:"100%",boxSizing:"border-box",padding:"6px 8px",fontSize:13,borderRadius:6,border:"1px solid #D1D5DB",outline:"none",marginBottom:8}}),d("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[o("button",{onClick:x,style:{flex:1,padding:"6px 0",fontSize:12,fontWeight:600,background:"#3B82F6",color:"#FFFFFF",border:"none",borderRadius:6,cursor:"pointer"},children:"Confirm"}),o("span",{onClick:g,style:{fontSize:12,color:"#6B7280",cursor:"pointer",textDecoration:"underline"},children:"Cancel"})]})]}),n.mode==="status"&&o("div",{style:{padding:"4px 0"},children:i.map(F=>o(It,{label:F==="NULL"?"Clear Status (NULL)":F,onClick:()=>I(F)},F))})]})},fn=({isError:n,onRetry:i,onDiscard:l})=>d("div",{style:{position:"absolute",inset:0,zIndex:2e3,background:"rgba(249,250,251,0.82)",display:"flex",alignItems:"center",justifyContent:"center"},children:[o("style",{children:"@keyframes ccl-spin { to { transform: rotate(360deg); } }"}),n?d("div",{style:{background:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:12,boxShadow:"0 4px 20px rgba(0,0,0,0.12)",padding:"24px 28px",display:"flex",flexDirection:"column",alignItems:"center",gap:12,maxWidth:300},children:[o("div",{style:{width:40,height:40,borderRadius:"50%",background:"#FEF2F2",border:"1px solid #FECACA",display:"flex",alignItems:"center",justifyContent:"center",fontSize:20,color:"#EF4444",fontWeight:700},children:"!"}),o("div",{style:{fontSize:15,fontWeight:700,color:"#111827"},children:"Save failed"}),o("div",{style:{fontSize:12,color:"#6B7280",textAlign:"center",lineHeight:1.5},children:"The allocation could not be saved. You can retry or discard your changes."}),d("div",{style:{display:"flex",gap:8,marginTop:4},children:[o("button",{onClick:l,style:{padding:"7px 16px",fontSize:12,fontWeight:600,borderRadius:6,border:"1px solid #D1D5DB",cursor:"pointer",background:"#FFFFFF",color:"#374151"},children:"Discard"}),o("button",{onClick:i,style:{padding:"7px 16px",fontSize:12,fontWeight:600,borderRadius:6,border:"none",cursor:"pointer",background:"#3B82F6",color:"#FFFFFF",boxShadow:"0 1px 3px rgba(59,130,246,0.3)"},children:"Retry"})]})]}):d("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:12},children:[o("div",{style:{width:32,height:32,borderRadius:"50%",border:"3px solid #E5E7EB",borderTopColor:"#3B82F6",animation:"ccl-spin 0.7s linear infinite"}}),o("span",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:"Saving\u2026"})]})]}),Te=({testName:n,priority:i,status:l,tooltipLines:g,scheduled:p,wrapperStyle:R,children:x})=>{let[I,W]=a.default.useState(!1),[U,lt]=a.default.useState({x:0,y:0,bottom:0}),[K,F]=a.default.useState(!1),dt=(0,a.useRef)(null),ct=(0,a.useRef)(null),ut=(0,a.useRef)(null),Mt=(0,a.useCallback)(()=>{if(ct.current){let E=ct.current.getBoundingClientRect();lt({x:E.left+E.width/2,y:E.top,bottom:E.bottom})}dt.current=window.setTimeout(()=>W(!0),400)},[]),pt=(0,a.useCallback)(()=>{dt.current&&clearTimeout(dt.current),W(!1),F(!1)},[]);a.default.useLayoutEffect(()=>{I&&ut.current&&ut.current.getBoundingClientRect().top<0&&F(!0)},[I,U]);let J=g.split(`
`).filter(E=>{let j=E.split(":");return j.length<2?E.trim()!=="":j.slice(1).join(":").trim()!==""}),Ft=d("div",{style:{background:"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:10,boxShadow:"0 4px 16px rgba(0,0,0,0.12), 0 1px 4px rgba(0,0,0,0.06)",padding:"12px 16px",maxWidth:300,minWidth:180},children:[o("div",{style:{fontSize:13,fontWeight:700,color:"#111827",marginBottom:6,lineHeight:1.3},children:n}),d("div",{style:{display:"flex",gap:10,alignItems:"center",marginBottom:8},children:[d("span",{style:{fontSize:13,fontWeight:700,color:Xt(i)},children:["P",i]}),o("span",{style:{fontSize:11,fontWeight:700,color:zt(l),textTransform:"uppercase",letterSpacing:"0.05em",padding:"1px 6px",background:`${at(l)}18`,borderRadius:4,border:`1px solid ${at(l)}40`},children:l})]}),o("div",{style:{height:1,background:"#E5E7EB",margin:"0 -4px 8px"}}),J.map((E,j)=>{let gt=E.indexOf(":");if(gt===-1)return o("div",{style:{fontSize:11,color:"#374151",marginBottom:3,lineHeight:1.4},children:E},j);let Et=E.slice(0,gt).trim(),wt=E.slice(gt+1).trim();return d("div",{style:{display:"flex",gap:6,fontSize:11,marginBottom:3,lineHeight:1.4},children:[d("span",{style:{color:"#6B7280",fontWeight:500,flexShrink:0},children:[Et,":"]}),o("span",{style:{color:"#111827",fontWeight:400},children:wt})]},j)}),p&&d(St,{children:[o("div",{style:{height:1,background:"#E5E7EB",margin:"6px -4px 6px"}}),d("div",{style:{display:"flex",gap:6,fontSize:11,marginBottom:2},children:[o("span",{style:{color:"#6B7280",fontWeight:500},children:"Starts:"}),o("span",{style:{color:"#111827"},children:p.start.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]}),d("div",{style:{display:"flex",gap:6,fontSize:11},children:[o("span",{style:{color:"#6B7280",fontWeight:500},children:"Ends:"}),o("span",{style:{color:"#111827"},children:p.end.toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})})]})]})]}),Q=o("div",{style:{width:10,height:10,background:"#FFFFFF",border:"1px solid #E5E7EB",borderTop:"none",borderLeft:"none",transform:"rotate(45deg)",margin:"-6px auto 0"}}),$=o("div",{style:{width:10,height:10,background:"#FFFFFF",border:"1px solid #E5E7EB",borderBottom:"none",borderRight:"none",transform:"rotate(45deg)",margin:"0 auto -6px"}});return d("div",{ref:ct,onMouseEnter:Mt,onMouseLeave:pt,style:R||{position:"relative"},children:[x,I&&o("div",{ref:ut,style:{position:"fixed",left:U.x,top:K?U.bottom+8:U.y-8,transform:K?"translate(-50%, 0)":"translate(-50%, -100%)",zIndex:1e3,pointerEvents:"none"},children:K?d(St,{children:[$,Ft]}):d(St,{children:[Ft,Q]})})]})},Pt=n=>{let i=[];return n.forEach(l=>{l.tests.forEach((g,p)=>{i.push({test_id:g.id,test_stand_id:l.id,priority_order:p+1})})}),i},Jt=n=>JSON.stringify(n.map(i=>`${i.test_id}:${i.test_stand_id}:${i.priority_order}`).sort()),Fn=()=>{let[n]=h.useStateArray({name:"tests",initialValue:[],inspector:"text",label:"Tests Data",description:"Array of test objects from getSchedulerData query"}),[i]=h.useStateArray({name:"testStands",initialValue:[],inspector:"text",label:"Test Stands Data",description:"Array of test stand objects from getTestStands query"}),[l]=h.useStateEnumeration({name:"saveMode",initialValue:"batch",enumDefinition:["batch","live"],inspector:"segmented",label:"Save Mode",description:"batch = save button, live = emit on every change"}),[g]=h.useStateBoolean({name:"isSaving",initialValue:!1,inspector:"checkbox",label:"Is Saving",description:"Bind to: {{ saveAllocations.isFetching }}"}),[p]=h.useStateBoolean({name:"hasSaveError",initialValue:!1,inspector:"checkbox",label:"Has Save Error",description:"Bind to: {{ !!saveAllocations.error }}"}),[R]=h.useStateString({name:"savedAt",initialValue:"",inspector:"text",label:"Saved At",description:"Bind to: {{ saveAllocations.lastRunAt }}"}),[x]=h.useStateBoolean({name:"isSavingDates",initialValue:!1,inspector:"checkbox",label:"Is Saving Planned Dates",description:"Bind to: {{ savePlannedDates.isFetching }}"}),[I]=h.useStateBoolean({name:"hasSaveDatesError",initialValue:!1,inspector:"checkbox",label:"Has Save Dates Error",description:"Bind to: {{ !!savePlannedDates.error }}"}),[W]=h.useStateNumber({name:"changeoverHours",initialValue:3,inspector:"text",label:"Changeover Hours",description:"Hours for changeover between tests (work hours only)"}),[U]=h.useStateNumber({name:"workStart",initialValue:9,inspector:"text",label:"Work Start Hour"}),[lt]=h.useStateNumber({name:"workEnd",initialValue:17,inspector:"text",label:"Work End Hour"}),[K]=h.useStateEnumeration({name:"defaultViewWeeks",initialValue:"4",enumDefinition:["2","4","8","12","24"],inspector:"segmented",label:"Default View"}),F=Number(K)||4,[dt]=h.useStateString({name:"cardMainText",initialValue:"{name}",inspector:"text",label:"Card Title",description:"Template for card title. Use {fieldName} for data fields."}),[ct]=h.useStateString({name:"cardSubText",initialValue:"Parts: {part_ready_date}",inspector:"text",label:"Card Subtitle",description:"Template for subtitle. Hidden when all fields are empty."}),[ut]=h.useStateString({name:"cardInfoRow",initialValue:"{owner} \xB7 {duration}h \xB7 P{priority}",inspector:"text",label:"Card Info Row",description:"Template for the info row shown on cards and bars."}),[Mt]=h.useStateString({name:"tooltipTemplate",initialValue:`Notes: {notes}
Owner: {owner}
Priority: {priority}
Part Status: {part_status}
Parts Due: {part_ready_date}
Assigned Parts: {assigned_parts}`,inspector:"text",label:"Tooltip Template",description:"Template for hover tooltip. Use \\n for newlines."}),[pt]=h.useStateArray({name:"statusOptions",initialValue:["NULL","Running","Created","Tested","Cancelled"],inspector:"text",label:"Status Options",description:"Status strings shown in the right-click Change Status menu. 'NULL' clears the status."}),[,J]=h.useStateArray({name:"allocations",initialValue:[],inspector:"hidden",description:"Current allocation state: [{test_id, test_stand_id, priority_order}]"}),[,Ft]=h.useStateArray({name:"allTestIds",initialValue:[],inspector:"hidden",description:"All test IDs managed by the scheduler (for the delete step in save)"}),[,Q]=h.useStateBoolean({name:"hasUnsavedChanges",initialValue:!1,inspector:"hidden",description:"Whether there are unsaved allocation changes"}),[,$]=h.useStateString({name:"selectedTestId",initialValue:"",inspector:"hidden",description:"ID of test actioned via right-click menu (set before events fire)"}),[,E]=h.useStateString({name:"selectedTestPriority",initialValue:"",inspector:"hidden",description:"New priority value from Change Priority action (numeric string)"}),[,j]=h.useStateString({name:"selectedTestStatus",initialValue:"",inspector:"hidden",description:"New status from Change Status action. Empty string = NULL in DB."}),[,gt]=h.useStateArray({name:"plannedDates",initialValue:[],inspector:"hidden",description:"Array of {test_id, planned_date} for all stand-scheduled tests. Use with savePlannedDates query."}),Et=h.useEventCallback({name:"onSave"}),wt=h.useEventCallback({name:"onChange"}),Zt=h.useEventCallback({name:"onRetry"}),te=h.useEventCallback({name:"onChangePriority"}),ee=h.useEventCallback({name:"onChangeStatus"}),ne=h.useEventCallback({name:"onEditTest"}),oe=h.useEventCallback({name:"onSavePlannedDates"});h.useComponentSettings({defaultHeight:600,defaultWidth:12});let[w,Ct]=a.default.useState([]),[B,Tt]=a.default.useState([]),[tt,Be]=a.default.useState(F||4),[y,Lt]=a.default.useState(null),[ke,ft]=a.default.useState(null),[Nt,et]=a.default.useState(null),[z,Bt]=a.default.useState(!1),[Re,q]=a.default.useState(!1),[re,nt]=a.default.useState(!1),[C,M]=a.default.useState(null),[Ht,Ot]=a.default.useState(""),[ie,Vt]=a.default.useState(!1),[ht,Ut]=a.default.useState(!1),$t=(0,a.useRef)(null),A=Re||g||re,kt=ie||x||ht;(0,a.useEffect)(()=>{g&&q(!1),p?(q(!1),nt(!0)):g||nt(!1)},[g,p]),(0,a.useEffect)(()=>{x&&Vt(!1),I?(Vt(!1),Ut(!0)):x||Ut(!1)},[x,I]),(0,a.useEffect)(()=>{if(!C)return;let t=r=>{$t.current&&!$t.current.contains(r.target)&&M(null)},s=r=>{r.key==="Escape"&&M(null)};return document.addEventListener("mousedown",t),document.addEventListener("keydown",s),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("keydown",s)}},[C]);let jt=(0,a.useRef)(""),se=a.default.useRef(""),Ae=(0,a.useRef)(null);(0,a.useEffect)(()=>{let t=R;if(!t||t===se.current)return;se.current=t;let s=Pt(w);jt.current=Jt(s),Bt(!1),q(!1),nt(!1)},[R,w]);let[yt,_e]=a.default.useState("az"),[mt,ae]=a.default.useState(""),Ie=(0,a.useMemo)(()=>{let t=Array.isArray(pt)?pt:[];return t.length>0?t.map(String):["NULL","Running","Created","Tested","Cancelled"]},[pt]),Pe=(0,a.useMemo)(()=>JSON.stringify(n)+JSON.stringify(i),[n,i]);(0,a.useEffect)(()=>{let t=Array.isArray(n)?n:[],s=Array.isArray(i)?i:[];if(s.length===0&&t.length===0)return;let r=new Map;s.forEach(u=>r.set(u.id,{id:u.id,name:u.name,tests:[]}));let f=[];t.forEach(u=>{let D={id:u.id,name:u.name||"",duration:u.duration||72,owner:u.owner||"",priority:u.priority??50,notes:u.notes||"",status:u.status||"",test_stand_id:u.test_stand_id,priority_order:u.priority_order,allocation_id:u.allocation_id,assigned_parts:u.assigned_parts||null,part_ready_date:u.part_ready_date||null,part_status:u.part_status||"",...u};D.test_stand_id!=null&&r.has(D.test_stand_id)?r.get(D.test_stand_id).tests.push(D):f.push(D)}),r.forEach(u=>{u.tests.sort((D,X)=>(D.priority_order||999)-(X.priority_order||999))});let e=s.map(u=>r.get(u.id));Ct(e),Tt(f),Bt(!1);let c=Pt(e);jt.current=Jt(c),J(c),Ft(t.map(u=>u.id)),Q(!1),q(!1),nt(!1)},[Pe]);let L=W||3,N=U||9,H=lt||17,S=(0,a.useMemo)(()=>{let t=new Date;for(t.setHours(0,0,0,0);t.getDay()!==1;)t.setDate(t.getDate()-1);return t},[]),bt=(0,a.useCallback)(t=>{let s=t.filter(b=>Dt(b)),r=t.filter(b=>!Dt(b)),f=[...s].sort((b,P)=>{let k=Wt(b.test_started_date)||new Date,_=Wt(P.test_started_date)||new Date;return k.getTime()!==_.getTime()?k.getTime()-_.getTime():(P.priority??50)-(b.priority??50)}),e=new Date(S),c=f.map(b=>{let P=Wt(b.test_started_date)||new Date(S),k=P<e?new Date(e):new Date(P),_=new Date(k.getTime()+b.duration*Z);return e=st(_,L,N,H),{...b,start:k,end:_}}),u=st(new Date,L,N,H),D=new Date(Math.max(e.getTime(),u.getTime())),X=r.map(b=>{let P=new Date(D),k=new Date(P.getTime()+b.duration*Z);return D=st(k,L,N,H),{...b,start:P,end:k}});return[...c,...X]},[S,L,N,H]),le=(0,a.useMemo)(()=>{let t=new Date(S);return t.setDate(t.getDate()+tt*7),w.forEach(s=>{let r=bt(s.tests);if(r.length>0){let f=r[r.length-1],e=st(f.end,L,N,H);e>t&&(t=e)}}),t.setDate(t.getDate()+7),t},[w,S,tt,L,N,H,bt]),ot=(0,a.useMemo)(()=>Math.ceil(G(S,le)/24),[S,le]),Y=(0,a.useMemo)(()=>{let t=[];return w.forEach(s=>{bt(s.tests).forEach(f=>{let e=f.start,c=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;t.push({test_id:f.id,planned_date:c})})}),t},[w,bt]);(0,a.useEffect)(()=>{gt(Y)},[Y]);let T=800/(tt*7*24),qt=(0,a.useMemo)(()=>an(S,ot),[S,ot]),We=(0,a.useMemo)(()=>ln(S,ot),[S,ot]),de=ot*24*T,vt=24*T,Rt=(0,a.useCallback)(t=>{let s=Pt(t),r=Jt(s)!==jt.current;Bt(r),J(s),Q(r),l==="live"&&(q(!0),wt())},[l,J,Q,wt]),xt=(0,a.useCallback)(t=>{let s=B.find(r=>r.id===t);if(s)return s;for(let r of w){let f=r.tests.find(e=>e.id===t);if(f)return f}return null},[B,w]),rt=(0,a.useCallback)(()=>{Lt(null),ft(null),et(null)},[]),At=(0,a.useCallback)((t,s)=>{if(!y)return;let r=xt(y);if(!r)return;Tt(e=>e.filter(c=>c.id!==y));let f=w.map(e=>{let c=e.tests.filter(u=>u.id!==y);if(e.id===t){let u=[...c];return u.splice(s,0,r),{...e,tests:u}}return{...e,tests:c}});Ct(f),Rt(f),rt()},[y,xt,w,Rt,rt]),Yt=(0,a.useCallback)(t=>{if(!y)return;let s=xt(y);if(!s)return;let r=w.map(f=>({...f,tests:f.tests.filter(e=>e.id!==y)}));Tt(f=>{let c=[...f.filter(u=>u.id!==y)];return c.splice(t,0,s),c}),Ct(r),Rt(r),rt()},[y,xt,w,Rt,rt]),ze=(0,a.useCallback)(()=>{q(!0),Et()},[Et]),Me=(0,a.useCallback)(()=>{Vt(!0),Ut(!1),oe()},[oe]),ce=(0,a.useCallback)(()=>{nt(!1),q(!1);let t=Array.isArray(n)?n:[],s=Array.isArray(i)?i:[],r=new Map;s.forEach(c=>r.set(c.id,{id:c.id,name:c.name,tests:[]}));let f=[];t.forEach(c=>{let u={...c,duration:c.duration||72,priority:c.priority??50};u.test_stand_id!=null&&r.has(u.test_stand_id)?r.get(u.test_stand_id).tests.push(u):f.push(u)}),r.forEach(c=>c.tests.sort((u,D)=>(u.priority_order||999)-(D.priority_order||999)));let e=s.map(c=>r.get(c.id));Ct(e),Tt(f),Bt(!1),J(Pt(e)),Q(!1)},[n,i,J,Q]),Le=(0,a.useCallback)(()=>{nt(!1),q(!0),Zt()},[Zt]),Ne=(0,a.useCallback)(()=>M(null),[]),He=(0,a.useCallback)(t=>{M(s=>s?{...s,mode:t}:null)},[]),Oe=(0,a.useCallback)(()=>{if(!C)return;let t=parseInt(Ht,10);isNaN(t)||t<0||t>100||($(String(C.test.id)),E(String(t)),te(),M(null))},[C,Ht,$,E,te]),Ve=(0,a.useCallback)(t=>{C&&($(String(C.test.id)),j(t==="NULL"?"":t),ee(),M(null))},[C,$,j,ee]),Ue=(0,a.useCallback)(()=>{C&&($(String(C.test.id)),ne(),M(null))},[C,$,ne]),ue=(0,a.useCallback)((t,s)=>({left:Math.max(0,G(S,t))*T,width:Math.max(s*T,2)}),[S,T]),$e=(0,a.useCallback)((t,s)=>{let r=Math.max(t.getTime(),S.getTime()),f=s.getTime();return f<=r?null:{left:G(S,new Date(r))*T,width:Math.max(G(new Date(r),new Date(f))*T,2)}},[S,T]),pe=y!=null?xt(y):null,it=pe!=null?Dt(pe):!1,ge=w.reduce((t,s)=>t+s.tests.length,0),je=w.reduce((t,s)=>t+s.tests.reduce((r,f)=>r+f.duration,0),0),Gt=String(dt||"{name}"),fe=String(ct||""),he=String(ut||""),ye=String(Mt||"").replace(/\\n/g,`
`),me={Running:0,Delayed:1,"On Time":2,Ready:3,"In Progress":4,"Parts Not Assigned":5},qe=(0,a.useMemo)(()=>{let t=[...B];if(mt.trim()){let s=mt.toLowerCase().trim();t=t.filter(r=>[r.name,r.owner,r.notes,r.status,r.part_status,r.assigned_parts,r.priority!=null?String(r.priority):"",r.duration!=null?String(r.duration):""].join(" ").toLowerCase().includes(s))}return yt==="az"?t.sort((s,r)=>(s.name||"").localeCompare(r.name||"")):yt==="priority"?t.sort((s,r)=>(r.priority??50)-(s.priority??50)):t.sort((s,r)=>{let f=me[_t(s)]??99,e=me[_t(r)]??99;return f!==e?f-e:(r.priority??50)-(s.priority??50)}),t},[B,yt,mt]),Ye=72,be=84;return d("div",{style:m.container,children:[A&&o(fn,{isError:re,onRetry:Le,onDiscard:ce}),d("div",{style:m.sidebar,children:[d("div",{style:{padding:"20px 16px 12px",borderBottom:"1px solid #E5E7EB"},children:[d("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[d("div",{style:{display:"flex",alignItems:"center",gap:8},children:[o("div",{style:{width:8,height:8,borderRadius:"50%",background:B.length>0?"#F59E0B":"#10B981"}}),o("span",{style:{...m.mono,fontSize:13,fontWeight:700,letterSpacing:"0.08em",textTransform:"uppercase",color:"#4B5563"},children:"Queue"})]}),o("div",{style:{display:"flex",gap:2,background:"#F3F4F6",borderRadius:6,padding:2,border:"1px solid #E5E7EB"},children:[["az","A\u2192Z"],["priority","Priority"],["status","Status"]].map(([t,s])=>o("button",{onClick:()=>_e(t),style:{...m.mono,padding:"3px 8px",fontSize:9,fontWeight:600,borderRadius:4,border:"none",cursor:"pointer",background:yt===t?"#3B82F6":"transparent",color:yt===t?"#FFF":"#6B7280"},children:s},t))})]}),d("div",{style:{position:"relative",marginTop:6},children:[o("input",{type:"text",value:mt,onChange:t=>ae(t.target.value),placeholder:"Filter tests...",style:{...m.mono,width:"100%",boxSizing:"border-box",padding:"5px 28px 5px 8px",fontSize:11,border:"1px solid #E5E7EB",borderRadius:6,background:"#F9FAFB",color:"#111827",outline:"none"},onFocus:t=>{t.currentTarget.style.borderColor="#3B82F6",t.currentTarget.style.background="#FFFFFF"},onBlur:t=>{t.currentTarget.style.borderColor="#E5E7EB",t.currentTarget.style.background="#F9FAFB"}}),mt&&o("button",{onClick:()=>ae(""),style:{position:"absolute",right:6,top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",color:"#9CA3AF",fontSize:14,lineHeight:1,padding:0},children:"\xD7"})]})]}),d("div",{style:{flex:1,overflowY:"auto",padding:"8px 10px"},onDragOver:t=>{t.preventDefault(),t.target===t.currentTarget&&et(B.length)},onDragLeave:t=>{t.currentTarget===t.target&&et(null)},onDrop:t=>{t.preventDefault(),Yt(Nt??B.length)},children:[qe.map((t,s)=>{let r=_t(t,null),f=!rn(fe,t);return d("div",{children:[o("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation(),et(s)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),Yt(s)},style:{height:Nt===s&&y&&y!==t.id?6:0,background:"#3B82F6",borderRadius:3,transition:"height 0.12s ease"}}),o(Te,{testName:V(Gt,t),priority:t.priority,status:r,tooltipLines:V(ye,t),children:d("div",{draggable:!0,onDragStart:e=>{e.dataTransfer.effectAllowed="move",Lt(t.id)},onDragEnd:rt,onDragOver:e=>{e.preventDefault(),e.stopPropagation();let c=e.currentTarget.getBoundingClientRect();et(e.clientY<c.top+c.height/2?s:s+1)},onMouseEnter:e=>{let c=e.currentTarget;c.style.transform="translateY(-2px)",c.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)",c.style.border=`2px solid ${at(r)}`},onMouseLeave:e=>{let c=e.currentTarget;c.style.transform="translateY(0)",c.style.boxShadow="0 1px 3px rgba(0,0,0,0.06)",c.style.border="1px solid #E5E7EB"},onContextMenu:e=>{e.preventDefault(),e.stopPropagation(),!(y||A)&&(Ot(String(t.priority??50)),M({x:e.clientX,y:e.clientY,test:t,mode:"root"}))},style:{display:"flex",marginBottom:6,background:y===t.id?"#F3F4F6":"#FFFFFF",border:"1px solid #E5E7EB",borderRadius:8,cursor:"grab",opacity:y===t.id?.35:1,overflow:"hidden",boxShadow:"0 1px 3px rgba(0,0,0,0.06)",transition:"transform 0.15s ease, box-shadow 0.15s ease, border 0.15s ease"},children:[o("div",{style:{width:5,minWidth:5,background:at(r),borderRadius:"8px 0 0 8px",flexShrink:0}}),d("div",{style:{flex:1,padding:"8px 12px",minWidth:0},children:[d("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[d("span",{style:{...m.mono,fontSize:13,fontWeight:700,color:Xt(t.priority)},children:["P",t.priority]}),o("span",{style:{...m.mono,fontSize:11,fontWeight:700,letterSpacing:"0.05em",color:zt(r),textTransform:"uppercase"},children:r.toUpperCase()})]}),o("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:2,lineHeight:1.3},children:V(Gt,t)}),f&&o("div",{style:{...m.mono,fontSize:11,color:"#6B7280",marginBottom:4,fontWeight:400},children:V(fe,t)}),o("div",{style:{...m.mono,display:"flex",gap:8,fontSize:11,color:"#4B5563",flexWrap:"wrap"},children:V(he,t).split("\xB7").map((e,c,u)=>d(a.default.Fragment,{children:[o("span",{children:e.trim()}),c<u.length-1&&o("span",{children:"\xB7"})]},c))})]})]})})]},t.id)}),o("div",{onDragOver:t=>{t.preventDefault(),et(B.length)},onDrop:t=>{t.preventDefault(),Yt(B.length)},style:{height:Nt===B.length&&y?6:0,background:"#3B82F6",borderRadius:3,transition:"height 0.12s ease",margin:"0 4px"}}),B.length===0&&o("div",{style:{textAlign:"center",padding:"32px 16px",color:"#6B7280",fontSize:12,border:y?"2px dashed #3B82F6":"2px dashed #D1D5DB",borderRadius:8,marginTop:8,background:y?"#EFF6FF":"transparent"},children:y?"Drop to return to queue":"All tests allocated"})]}),o(pn,{}),o("div",{style:{padding:"12px 16px",borderTop:"1px solid #E5E7EB",background:"#F9FAFB"},children:d("div",{style:{...m.mono,display:"flex",justifyContent:"space-between",fontSize:10,color:"#6B7280"},children:[d("span",{children:[ge,"/",ge+B.length," allocated"]}),d("span",{children:[je,"h"]})]})})]}),d("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[d("div",{style:{padding:"12px 24px",borderBottom:"1px solid #E5E7EB",background:"#FFFFFF",display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,flexWrap:"wrap"},children:[d("div",{style:{minWidth:0},children:[o("h1",{style:{fontSize:18,fontWeight:700,color:"#111827",letterSpacing:"-0.02em"},children:"Test Stand Scheduler"}),d("p",{style:{...m.mono,fontSize:11,color:"#6B7280",marginTop:2},children:["Continuous testing \xB7 ",L,"h changeover (",N,":00\u2013",H,":00 Mon\u2013Fri)",l==="live"&&o("span",{children:" \xB7 Live sync"})]})]}),d("div",{style:{display:"flex",alignItems:"center",gap:12},children:[l==="batch"&&d("div",{style:{display:"flex",gap:6},children:[o("button",{onClick:ce,disabled:!z||A,style:{...m.mono,padding:"6px 14px",fontSize:11,fontWeight:600,borderRadius:6,border:"1px solid #D1D5DB",cursor:z&&!A?"pointer":"default",background:"#FFFFFF",color:z&&!A?"#374151":"#9CA3AF",opacity:z&&!A?1:.5},children:"Discard"}),d("button",{onClick:ze,disabled:!z||A,style:{...m.mono,padding:"6px 14px",fontSize:11,fontWeight:600,borderRadius:6,border:"none",cursor:z&&!A?"pointer":"default",background:z&&!A?"#3B82F6":"#93C5FD",color:"#FFFFFF",boxShadow:z&&!A?"0 1px 3px rgba(59,130,246,0.3)":"none"},children:["Save Changes",z&&" \u2022"]})]}),o("button",{onClick:Me,disabled:kt||Y.length===0,title:Y.length===0?"No tests scheduled":`Save planned start dates for ${Y.length} scheduled test${Y.length!==1?"s":""}`,style:{...m.mono,padding:"6px 14px",fontSize:11,fontWeight:600,borderRadius:6,border:ht?"1px solid #FECACA":"1px solid #D1D5DB",cursor:!kt&&Y.length>0?"pointer":"default",background:ht?"#FEF2F2":"#FFFFFF",color:ht?"#EF4444":kt?"#9CA3AF":"#374151",opacity:!kt&&Y.length>0?1:.6,transition:"background 0.15s, color 0.15s, border-color 0.15s"},children:ht?"Error \u2014 Retry":ie||x?"Saving\u2026":"Save Planned Dates"}),o("div",{style:{display:"flex",gap:4,background:"#F3F4F6",borderRadius:8,padding:3,border:"1px solid #E5E7EB"},children:[2,4,8,12,24].map(t=>d("button",{onClick:()=>Be(t),style:{...m.mono,padding:"6px 12px",fontSize:11,fontWeight:600,borderRadius:6,border:"none",cursor:"pointer",background:tt===t?"#3B82F6":"transparent",color:tt===t?"#FFF":"#4B5563"},children:[t,"W"]},t))})]})]}),o("div",{ref:Ae,style:{flex:1,overflow:"auto",background:"#F9FAFB"},children:d("div",{style:{minWidth:de,padding:"0 12px 24px",position:"relative"},children:[d("div",{style:{position:"sticky",top:0,zIndex:20,background:"#F9FAFB",borderBottom:"1px solid #E5E7EB"},children:[o("div",{style:{display:"flex",height:28,position:"relative",borderBottom:"1px solid #E5E7EB"},children:We.map((t,s)=>o("div",{style:{...m.mono,position:"absolute",left:G(S,t)*T,width:7*24*T,height:28,display:"flex",alignItems:"center",paddingLeft:8,fontSize:10,fontWeight:600,color:"#4B5563",borderLeft:s>0?"1px solid #E5E7EB":"none"},children:dn(t)},s))}),o("div",{style:{display:"flex",height:24},children:qt.map((t,s)=>{let r=t.toDateString()===new Date().toDateString(),f=t.getDay()===0||t.getDay()===6;return o("div",{style:{...m.mono,width:vt,minWidth:vt,fontSize:9,textAlign:"center",color:r?"#2563EB":"#6B7280",fontWeight:r?700:400,lineHeight:"24px",borderLeft:"1px solid #E5E7EB",background:r?"#EFF6FF":f?"#F3F4F6":"transparent"},children:tt<=8||t.getDay()===1?t.getDate():""},s)})})]}),w.map(t=>{let s=bt(t.tests),r=ke,f=r&&r.standId===t.id;return d("div",{style:{marginTop:16},children:[d("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6,paddingLeft:2},children:[o("div",{style:{width:6,height:6,borderRadius:2,background:t.tests.length>0?"#3B82F6":"#9CA3AF"}}),o("span",{style:{...m.mono,fontSize:11,fontWeight:600,color:"#374151"},children:t.name}),d("span",{style:{...m.mono,fontSize:10,color:"#6B7280"},children:[t.tests.length," test",t.tests.length!==1?"s":"",t.tests.length>0&&` \xB7 ${t.tests.reduce((e,c)=>e+c.duration,0)}h`]})]}),d("div",{onDragOver:e=>{e.preventDefault(),ft({standId:t.id,index:t.tests.length})},onDragLeave:e=>{e.currentTarget.contains(e.relatedTarget)||ft(null)},onDrop:e=>{e.preventDefault(),it?At(t.id,t.tests.length):At(t.id,r?.standId===t.id?r.index:t.tests.length)},style:{position:"relative",height:be,background:(()=>f||y&&t.tests.length===0?it?"#F5F3FF":"#EFF6FF":"#F3F4F6")(),border:`1px solid ${(()=>f||y&&t.tests.length===0?it?"#A78BFA":"#BFDBFE":"#E5E7EB")()}`,borderRadius:8,width:de,transition:"background 0.15s ease, border-color 0.15s ease"},children:[qt.map((e,c)=>e.getDay()!==0&&e.getDay()!==6?null:o("div",{style:{position:"absolute",left:c*vt,top:0,bottom:0,width:vt,background:"#E5E7EB",pointerEvents:"none"}},`we-${c}`)),qt.map((e,c)=>o("div",{style:{position:"absolute",left:c*vt,top:0,bottom:0,width:1,background:"#E5E7EB"}},c)),(()=>{let e=G(S,new Date);return e<0||e>ot*24?null:o("div",{style:{position:"absolute",left:e*T,top:0,bottom:0,width:2,background:"#EF4444",zIndex:10},children:o("div",{style:{position:"absolute",top:-3,left:-3,width:8,height:8,borderRadius:"50%",background:"#EF4444"}})})})(),s.map((e,c)=>{let u=Dt(e),D=u?$e(e.start,e.end):ue(e.start,e.duration);if(!D)return null;let{left:X,width:b}=D,P=st(e.end,L,N,H),k=G(e.end,P)*T,_=_t(e,e.start),ve=V(Gt,e),xe=V(he,e),Ge=xe.trim()!==""&&b>120;return d("div",{style:{position:"absolute",left:X,top:0,width:b+k,height:"100%"},children:[y&&y!==e.id&&!it&&d(St,{children:[o("div",{onDragOver:v=>{v.preventDefault(),v.stopPropagation(),ft({standId:t.id,index:c})},onDrop:v=>{v.preventDefault(),v.stopPropagation(),At(t.id,c)},style:{position:"absolute",left:-6,top:0,width:"50%",height:"100%",zIndex:20,minWidth:20}}),o("div",{onDragOver:v=>{v.preventDefault(),v.stopPropagation(),ft({standId:t.id,index:c+1})},onDrop:v=>{v.preventDefault(),v.stopPropagation(),At(t.id,c+1)},style:{position:"absolute",right:-6,top:0,width:"50%",height:"100%",zIndex:20,minWidth:20}})]}),f&&!it&&r.index===c&&o("div",{style:{position:"absolute",left:-4,top:0,bottom:0},children:o(Ce,{})}),o(Te,{testName:ve,priority:e.priority,status:_,tooltipLines:V(ye,e),scheduled:u?null:e,wrapperStyle:{position:"absolute",left:0,top:0,width:b,height:"100%"},children:d("div",{draggable:!0,onDragStart:v=>{v.dataTransfer.effectAllowed="move",v.dataTransfer.setData("text/plain",String(e.id)),Lt(e.id)},onDragEnd:rt,onMouseEnter:v=>{if(!y){let O=v.currentTarget;O.style.transform="translateY(-2px)",O.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)",O.style.border=`2px solid ${at(_)}`,O.style.zIndex="25"}},onMouseLeave:v=>{let O=v.currentTarget;O.style.transform="translateY(0)",O.style.boxShadow="0 1px 3px rgba(0,0,0,0.06)",O.style.border=u?"1px solid #C4B5FD":"1px solid #E5E7EB",O.style.zIndex="15"},onContextMenu:v=>{v.preventDefault(),v.stopPropagation(),!(y||A)&&(Ot(String(e.priority??50)),M({x:v.clientX,y:v.clientY,test:e,mode:"root"}))},style:{position:"absolute",left:0,top:6,width:b,height:Ye,background:u?"#F3E8FF":"#FFFFFF",borderRadius:8,cursor:"grab",display:"flex",flexDirection:"row",overflow:"hidden",opacity:y===e.id?.25:1,zIndex:15,border:u?"1px solid #C4B5FD":"1px solid #E5E7EB",boxShadow:u?"0 1px 3px rgba(147,51,234,0.15)":"0 1px 3px rgba(0,0,0,0.06)",transition:"transform 0.15s ease, box-shadow 0.15s ease, border 0.15s ease"},children:[o("div",{style:{width:5,minWidth:5,background:at(_),flexShrink:0}}),d("div",{style:{flex:1,display:"flex",flexDirection:"column",padding:"4px 8px",minWidth:0,justifyContent:"center"},children:[b>70&&d("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:2},children:[o("span",{style:{...m.mono,fontSize:b>120?11:9,fontWeight:700,color:u?"#7E22CE":Xt(e.priority)},children:u?"\u25B6 RUNNING":`P${e.priority}`}),b>100&&!u&&o("span",{style:{...m.mono,fontSize:9,fontWeight:700,letterSpacing:"0.05em",color:zt(_),textTransform:"uppercase"},children:_.toUpperCase()})]}),o("span",{style:{fontSize:b>120?12:b>80?11:10,fontWeight:600,color:u?"#3B0764":"#111827",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",lineHeight:1.2},children:ve}),Ge&&o("span",{style:{...m.mono,fontSize:9,fontWeight:400,color:u?"#7E22CE":"#4B5563",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%",marginTop:2},children:xe})]})]})}),c<s.length&&k>0&&o("div",{style:{position:"absolute",left:b,top:be/2-8,width:k,height:16,display:"flex",alignItems:"center",justifyContent:"center"},children:o("div",{style:{height:1,width:"80%",background:"repeating-linear-gradient(90deg, #9CA3AF 0, #9CA3AF 4px, transparent 4px, transparent 8px)"}})})]},e.id)}),f&&!it&&r.index===t.tests.length&&s.length>0&&(()=>{let e=s[s.length-1],{left:c,width:u}=ue(e.start,e.duration),D=st(e.end,L,N,H),X=G(e.end,D)*T;return o("div",{style:{position:"absolute",left:c+u+X+8,top:0,bottom:0},children:o(Ce,{})})})(),t.tests.length===0&&o("div",{style:{...m.mono,position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,color:y?"#3B82F6":"#9CA3AF",fontWeight:y?600:400},children:y?"Drop here to schedule":"Drop tests here to schedule"})]})]},t.id)}),w.length===0&&o("div",{style:{...m.mono,textAlign:"center",padding:"48px 24px",color:"#6B7280",fontSize:12},children:"No test stands loaded. Bind the testStands property to your getTestStands query."})]})})]}),C&&o(gn,{menu:C,statusOptionsList:Ie,priorityInputValue:Ht,onClose:Ne,onModeChange:He,onPriorityInputChange:Ot,onConfirmPriority:Oe,onPickStatus:Ve,onEditTest:Ue,panelRef:$t})]})};export{Fn as TestStandScheduler};
